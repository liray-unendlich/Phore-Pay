$(function(){$.getJSON("https://api.coinmarketcap.com/v1/ticker/phore/?convert=JPY").done(function(a){if(a[0].id){result=a[0].price_jpy;var b=1;rate=Math.floor(result*Math.pow(10,b))/Math.pow(10,b);$("#rate").html("<b>"+rate+"</b>")}else{$("#rate").html("価格が取得できません。")}});setInterval(function(){$.getJSON("https://api.coinmarketcap.com/v1/ticker/phore/?convert=JPY").done(function(a){if(a[0].id){result=a[0].price_jpy;var b=1;rate=Math.floor(result*Math.pow(10,b))/Math.pow(10,b);$("#rate").html("<b>"+rate+"</b>")}else{$("#rate").html("価格が取得できません。")}})},10000);$("#twrequest").click(function(){$("#qrcode").html("");$("#addqrcode").html("");$("#lineqrcode").html("");$("#qrcode").css("display","none");$("#addqrcode").css("display","none");$("#lineqrcode").css("display","none");$("#twitter").css("display","none");$("#addtwitter").css("display","none");$("#line").css("display","none");fee=$("#fee").val();user=$("#user").val();name=user.substr(1);if(fee==""){alert("請求額が入力されていません")}else{if(!fee.match(/^[0-9]+$/)){alert("請求額には数字のみ入力してください")}else{if(user==""){alert("支払い先アカウント名が入力されていません")}else{if(user.slice(0,1)!="@"){alert("支払い先アカウント名は@から始まるものを入力してください")}else{if(!user.match(/^[@0-9a-zA-Z_]+$/)){alert("ユーザー名には半角英数字,アンダーバーのみが利用できます")}else{if(name.match(/[@]/)){alert("ユーザー名には半角英数字,アンダーバーのみが利用できます")}else{var f=3;var e=fee/result;var b=Math.ceil(e*Math.pow(10,f))/Math.pow(10,f);$("#bill").html("<b>"+b+"</b>");var c="@tipsensu tip phr "+b+" "+user;var a="twitter://post?message="+encodeURIComponent(c);$("#qrcode").css("background-color","white");$("#qrcode").qrcode({width:200,height:200,foreground:"black",background:"white",text:a});$("#qrcode").css("display","block");$("#twitter").css("display","inline");var d=document.getElementById("twitter");d.href=a;d.innerText="Twitterで支払う"}}}}}}});$("#addrequest").click(function(){$("#qrcode").html("");$("#addqrcode").html("");$("#lineqrcode").html("");$("#qrcode").css("display","none");$("#addqrcode").css("display","none");$("#lineqrcode").css("display","none");$("#twitter").css("display","none");$("#addtwitter").css("display","none");$("#line").css("display","none");fee=$("#fee").val();address=$("#address").val();if(fee==""){alert("請求額が入力されていません")}else{if(!fee.match(/^[0-9]+$/)){alert("請求額には数字のみ入力してください")}else{if(address==""){alert("アドレスが入力されていません")}else{if(!address.match(/^[0-9a-zA-Z]+$/)){alert("アドレスには半角英数字のみ入力してください")}else{if(address.slice(0,1)!="P"){alert("PhoreアドレスはPから始まるものを入力してください")}else{if(address.length!=34){alert("アドレスの入力を間違えているようです。入力内容をご確認ください")}else{var f=3;var e=fee/result;var b=Math.ceil(e*Math.pow(10,f))/Math.pow(10,f);$("#bill").html("<b>"+b+"</b>");var c="@tipsensu withdraw phr "+b+" "+address;var a="twitter://post?message="+encodeURIComponent(c);$("#addqrcode").css("background-color","white");$("#addqrcode").qrcode({width:200,height:200,foreground:"black",background:"white",text:a});$("#addqrcode").css("display","block");$("#addtwitter").css("display","inline");var d=document.getElementById("addtwitter");d.href=a;d.innerText="アドレスへ送金"}}}}}}});$("#linerequest").click(function(){$("#qrcode").html("");$("#addqrcode").html("");$("#lineqrcode").html("");$("#qrcode").css("display","none");$("#addqrcode").css("display","none");$("#lineqrcode").css("display","none");$("#twitter").css("display","none");$("#addtwitter").css("display","none");$("#line").css("display","none");fee=$("#fee").val();user=$("#user").val();name=user.substr(1);address=$("#address").val();if(fee==""){alert("請求額が入力されていません")}else{if(!fee.match(/^[0-9]+$/)){alert("請求額には数字のみ入力してください")}else{if(address==""){alert("アドレスが入力されていません")}else{if(!address.match(/^[0-9a-zA-Z]+$/)){alert("アドレスには半角英数字のみ入力してください")}else{if(address.slice(0,1)!="P"){alert("PhoreアドレスはPから始まるものを入力してください")}else{if(address.length!=34){alert("アドレスの入力を間違えているようです。入力内容をご確認ください")}else{var f=3;var e=fee/result;var b=Math.ceil(e*Math.pow(10,f))/Math.pow(10,f);$("#bill").html("<b>"+b+"</b>");var c="./withdraw phr "+b+" "+address;var a="twitter://post?message="+encodeURIComponent(c);$("#lineqrcode").css("background-color","white");$("#lineqrcode").qrcode({width:200,height:200,foreground:"black",background:"white",text:a});$("#lineqrcode").css("display","block");$("#line").css("display","inline");var d=document.getElementById("line");d.href=a;d.innerText="LINEで送金"}}}}}}});$(document).ready(function(){$(".drawer").drawer()});$("#reset").click(function(){return confirm("入力データをリセットしますか？");$("#fee").garlic();$("#user").garlic();$("#address").garlic()})});function openQRCamera(b){var a=new FileReader();a.onload=function(){b.value="";qrcode.callback=function(c){if(c instanceof Error){alert("QRコードが見つかりません。カメラの撮影範囲内にQRコードが存在することをお確かめください。")}else{b.parentNode.previousElementSibling.value=c}};qrcode.decode(a.result)};a.readAsDataURL(b.files[0])}function showQRIntro(){return confirm("カメラを使ってQRコードの写真を撮影してください。")};